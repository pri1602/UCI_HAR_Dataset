setwd("~/R/Coursera/Getting and Cleaning Data/Course Project")
fileurl <- "https://d396qusza40orc.cloudfront.net/getdata%2Fprojectfiles%2FUCI%20HAR%20Dataset.zip"
td <- tempdir()
tf <- tempfile(tmpdir=td, fileext=".zip") 
download.file(fileurl, tf)
fname <- unzip(tf, exdir=td, overwrite=TRUE, list=TRUE)
head(fname)
fpath_test <- file.path(td, fname$Name[17])
test_data <- read.table(fpath_test)
head(test_data)
fpath_train <- file.path(td,fname$Name[31])
train_data <- read.table(fpath_train)
head(train_data)
library(dplyr)
merged <- full_join(test_data, train_data)
head(merged)
fpath_varnames <- file.path(td,fname$Name[2])
varnames <- read.table(fpath_varnames)
varnames <- select(varnames, V2)
transp_var <- t(varnames)
variables <- as.vector(transp_var)
names(merged) <- variables
head(merged)
find_vars <- grep('mean|std',names(merged))
data <- merged[,find_vars]
head(data)
fpath_ytest <- file.path(td, fname$Name[18])
ytest <- read.table(fpath_ytest)
fpath_ytrain <- file.path(td, fname$Name[32])
ytrain <- read.table(fpath_ytrain)
activity <- append(ytest$V1,ytrain$V1)
activity_data <- cbind(activity, data)
str(activity_data)
fpath_activity <- file.path(td, fname$Name[1])
activity_labels <- read.table(fpath_activity)
activity_labels
activity_data$activity <- gsub(1, "WALKING", activity_data$activity)
activity_data$activity <- gsub(2, "WALKING_UPSTAIRS", activity_data$activity)
activity_data$activity <- gsub(3, "WALKING_DOWNSTAIRS", activity_data$activity)
activity_data$activity <- gsub(4, "SITTING", activity_data$activity)
activity_data$activity <- gsub(5, "STANDING", activity_data$activity)
activity_data$activity <- gsub(6, "LAYING", activity_data$activity)
View(activity_data)
names(activity_data) <- gsub("-", "_", names(activity_data))
names(activity_data) <- gsub("[()]", "", names(activity_data))
names(activity_data)
fpath_subjectID_test <- file.path(td, fname$Name[16])
subjectID_test <- read.table(fpath_subjectID_test)
head(subjectID_test)
fpath_subjectID_train <- file.path(td,fname$Name[30])
subjectID_train <- read.table(fpath_subjectID_train)
head(subjectID_train)
subjectID <- append(subjectID_test$V1, subjectID_train$V1)
g <- cbind(subjectID, activity_data)
x <- aggregate(g[,-(1:2)], list(subjectID,activity),mean)
x$Group.2 <- gsub(1, "WALKING", x$Group.2)
x$Group.2 <- gsub(2, "WALKING_UPSTAIRS", x$Group.2)
x$Group.2 <- gsub(3, "WALKING_DOWNSTAIRS", x$Group.2)
x$Group.2 <- gsub(4, "SITTING", x$Group.2)
x$Group.2 <- gsub(5, "STANDING", x$Group.2)
x$Group.2 <- gsub(6, "LAYING",x$Group.2)
names(x) <- gsub("mean", "groupMean", names(x))
names(x) <- gsub("std", "groupStd", names(x))
names(x)[names(x)=="Group.1"] <- "subjectID"
names(x)[names(x)=="Group.2"] <- "activity"
View(x)
write.table(x, file="har_data.txt", row.names=F)